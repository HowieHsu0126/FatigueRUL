# Time Series Deep Learning Model Configuration File
# Manages deep learning model parameters for time series prediction

# Model paths configuration
model_paths:
  # Model save paths
  models_dir: "Output/models"
  best_model: "Output/models/best_model.pth"
  all_models: "Output/models/all_models.pth"
  model_metrics: "Output/models/model_metrics.json"
  
  # Results save paths
  results_dir: "Output/results"
  experiment_results: "Output/results/experiment_results.json"
  cross_validation_results: "Output/results/cross_validation_results.json"
  prediction_results: "Output/results/prediction_results.json"
  
  # Logs path
  logs_dir: "Output/logs"

# Deep learning models configuration
deep_learning_models:
  # LSTM model
  lstm:
    enable: true
    input_dim: null  # Determined by data loader (num_sensors * 2)
    hidden_dim: 96
    num_layers: 2
    dropout_rate: 0.35
    bidirectional: true
    batch_first: true
    
  # GRU model
  gru:
    enable: true
    input_dim: null
    hidden_dim: 96
    num_layers: 2
    dropout_rate: 0.35
    bidirectional: true
    batch_first: true
    
  # Transformer model
  transformer:
    enable: true
    input_dim: null
    d_model: 96
    nhead: 4
    num_layers: 2
    dropout_rate: 0.25
    batch_first: true
    
  # RNN model (simple)
  rnn:
    enable: false
    input_dim: 20
    hidden_dim: 128
    num_layers: 2
    dropout_rate: 0.3
    bidirectional: false
    batch_first: true

  # CNN-LSTM hybrid model
  cnn_lstm:
    enable: true
    input_dim: null  # Determined by data loader
    cnn_filters: [32, 64]
    cnn_kernel_size: 3
    lstm_hidden_dim: 96
    lstm_num_layers: 2
    dropout_rate: 0.35
    device: "cuda"

  # Temporal Convolutional Network (TCN)
  tcn:
    enable: true
    input_dim: null  # Determined by data loader
    num_channels: [64, 128]
    kernel_size: 3
    dropout_rate: 0.3
    device: "cuda"

  # Attention-LSTM model
  attention_lstm:
    enable: true
    input_dim: null  # Determined by data loader
    lstm_hidden_dim: 96
    lstm_num_layers: 2
    attention_dim: 64
    dropout_rate: 0.35
    device: "cuda"

  # Spatio-temporal GNN model
  gnn:
    enable: true
    # num_nodes is dynamically determined from available sensors in dataset.yaml
    # Do not set num_nodes here, it will be computed from actual sensor data
    input_dim: 10  # Updated: 5 features per sensor (force: mean, std, max, min, slope; displacement: mean, std, max, min, slope)
    hidden_dim: 96  # Reduced from 128 for better stability
    num_layers: 2
    dropout_rate: 0.2
    device: "cuda"

# Training configuration
training:
  # Basic training parameters
  batch_size: 32
  num_epochs: 100
  learning_rate: 0.001
  weight_decay: 0.0001
  
  # Early stopping
  early_stopping:
    enable: true
    patience: 15
    min_delta: 0.001
    restore_best_weights: true
    monitor: "val_loss"
    
  # Model checkpointing
  checkpointing:
    enable: true
    save_best_model: true
    save_frequency: 10  # Save every N epochs
    
  # Optimizer configuration
  optimizer:
    type: "adam"  # adam, adamw, sgd
    weight_decay: 0.0001
    betas: [0.9, 0.999]
    momentum: 0.9  # for SGD
    
  # Learning rate scheduler configuration
  scheduler:
    type: "reduce_on_plateau"  # reduce_on_plateau, step, cosine
    factor: 0.5
    patience: 10
    step_size: 30
    gamma: 0.1
    T_max: 100
    eta_min: 1e-6

# Model evaluation configuration
evaluation:
  metrics:
    - "mse"
    - "mae" 
    - "r2"
    - "rmse"
    - "relative_error"
    
  # Cross validation configuration
  cross_validation:
    n_splits: 5
    shuffle: true
    random_state: 42
    
  # Feature importance analysis
  feature_importance:
    enable: true
    top_n: 20

# Model saving configuration
model_saving:
  save_all_models: true
  save_best_model: true
  save_model_architecture: true
  save_training_history: true
  model_format: "pth"  # pth, pkl, joblib

# Device configuration
device:
  use_cuda: true
  cuda_device: 0
  mixed_precision: false